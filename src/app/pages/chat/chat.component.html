<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Chat</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='chat.component.css'>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src='main.js'></script>
</head>

<body>
    <header>
        <app-header-layout></app-header-layout>
    </header>
    <main>
        <aside class="menuL">
            <app-sidebar></app-sidebar>
        </aside>
        <article>
            <div class="container">
                <div class="row no-gutters">
                    <div class="col-md-4 border-right">
                        <div class="settings-tray">
                            <img class="profile-image"
                                src="https://www.clarity-enhanced.net/wp-content/uploads/2020/06/filip.jpg"
                                alt="Profile img">
                            <span class="settings-tray--right">
                                <button type="button" (click)="allChats()">Desplegar chats</button>
                            </span>
                        </div>
                        <div class="search-box">
                            <div class="input-wrapper">
                                <i class="material-icons">search</i>
                                <input placeholder="Search here" type="text">
                            </div>
                        </div>
                        <div *ngFor="let chat of chats">
                        <a (click)="getMensajes(chat.id)"> <div class="friend-drawer friend-drawer--onhover">
                            <img class="profile-image" src="https://www.clarity-enhanced.net/wp-content/uploads/2020/06/robocop.jpg" alt="">                            
                            <div class="text" *ngIf="chat.nickname_receptor != userService.user.nickname; else emisor">                                
                                <h6>{{chat.nickname_receptor}}</h6>
                                <ng-template #emisor>
                                    <h6>{{chat.nickname_emisor}}</h6>
                                </ng-template>
                                <p class="text-muted">Hey, you're arrested!</p>
                            </div>
                            <span class="time text-muted small">13:21</span>
                        </div> </a> </div>
                        <hr>
                    </div>
                    <div class="col-md-8">
                        <div class="settings-tray">
                            <div class="friend-drawer no-gutters friend-drawer--grey">
                                <img class="profile-image"
                                    src="userService.user.foto"
                                    alt="">
                                <div class="text">
                                    <h6>{{userService.user.nickname}}</h6>
                                    <p class="text-muted">Layin' down the law since like before Christ...</p>
                                </div>
                                <span class="settings-tray--right">
                                    <i class="material-icons">cached</i>
                                    <i class="material-icons">message</i>
                                    <i class="material-icons">menu</i>
                                </span>
                            </div>
                        </div>
                        <div class="chat-panel">
                            <div class="row no-gutters" *ngFor="let mensajes of mensajesReci">
                                <div class="col-md-3">
                                    <div class="chat-bubble chat-bubble--left">
                                                {{mensajes.mensaje}}
                                    </div>
                                </div>
                            </div>
                            <div class="row no-gutters" *ngFor="let mensajes of mensajesEnvi">
                                <div class="col-md-3 offset-md-9">
                                    <div class="chat-bubble chat-bubble--right">
                                        {{mensajes.mensaje}}
                                    </div>
                                </div>
                            </div>
                        </div>
                    <div class="row">
                        <div class="col-12">
                            <div id="escribe" class="chat-box-tray">
                                <input type="text" placeholder="Type your message here..." #mensaje>
                                <button type="button" (click)="nuevoMensaje(mensaje, 2)">Send</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            </div>
            <script>
                $('.friend-drawer--onhover').on('click', function () {
                    $('.chat-bubble').hide('slow').show('slow');
                });
            </script>
        </article>
    </main>

    <footer>
        <app-footer></app-footer>
    </footer>
</body>

</html>